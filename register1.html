<!doctype html>
<html>
    <head>
     <style>
        .error{color:orange;}
        </style>
</head>
    <body>
        <?php
        $nameErr = $emailErr = $genderErr = $websiteErr = "";
        $name = $email = $gender = $comment = $website ="";

       // we can use validation for this method
        if($_SERVER["REQUEST_METHOD"]=="POST"){
            if(empty($_POST["name"])){
                $nameErr="Name is required";
            }else{
                $name=type_data($_POST["name"]);
                $pre="/^[a-zA-Z-' ]*$/";
                if(!preg_match($pre,$name)){
                    $nameErr="Only letter and white space are allowed";
                }
            }

           if(empty($_POST["email"])){
            $emailErr="Email is required";
           }else{
            $email=type_data($_POST["email"]);
            if(!filter_var($email, FILTER_VALIDATE_EMAIL)){
                $domain = substr(strrchr($email, "@"), 1); 
                if (checkdnsrr($domain, "MX")) {
                    echo "Valid email address with existing domain.";
                } else {
                    echo "Email domain does not exist.";
                }
            }
                else {
                    echo "Invalid email format.";
                }
                
            }
            if(empty($_POST["website"])){
                $website=" ";
            }else{
                $website=type_data($_POST["website"]);
                if (!preg_match("/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&@#\/%?=~_|!:,.;]*[-a-z0-9+&@#\/%=~_|]/i",$website)) {  
                    $websiteErr = "Invalid URL";  
                }      
            }

            if(empty($_POST["comment"])){
                $comment=" ";
            }else{
                $comment=type_data($_POST["comment"]);
            }

            if(empty($_POST["gender"])){
                $genderErr="gender is required";
            }else{
                $gender=type_data($_POST["gender"]);
            }    
        }
        function type_data($data){
            $data=trim($data);
            $data=stripslashes($data);
            $data=htmlspecialchars($data);
            return $data;
        }
        ?>
         <p><span class="error">* required field</span></p>
        <form method="post" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]);?>">
           Name: <input type="text" name="name" required>
           <span class="error">* <?php echo $nameErr;?></span>
           <br><br>
           Email: <input type="text" name="email" required>
           <span class="error">* <?php echo $emailErr;?></span>
           <br><br>
           website: <input type="text" name="website" required>
           <span class="error">* <?php echo $websiteErr;?></span>
           <br><br>
           Comment: <textarea name="comment" rows="5" cols="40" required></textarea>

           <br><br>
           Gender:
           <input type="radio" name="gender" value="Male">Male
           <input type="radio" name="gender" value="Female">Female
           <input type="radio" name="gender" value="Other">Other
           <span class="error">* <?php echo $genderErr;?></span>
           <br><br>
           <input type="submit" name="submit" value="submit">
</form>
<?php
 if(isset($_POST['submit'])) {  
    if($nameErr == "" && $emailErr == "" &&  $genderErr == "" && $websiteErr == "" ) {  
        echo "<h3 color = #FF0001> <b>You have sucessfully registered.</b> </h3>";  
        echo "<h2>Your Input:</h2>";  
        echo "Name: " .$name;  
        echo "<br>";  
        echo "Email: " .$email;  
        echo "<br>";  
        echo "Website: " .$website; 
        echo "<br>";  
        echo "comment: " .$comment; 
        echo "<br>";  
        echo "Gender: " .$gender;  
        
       
    } else {  
        echo "<h3> <b>You didn't filled up the form correctly.</b> </h3>";  
    }  
    }  
?>
</body>
</html>

<?php
if (isset($_POST['submit'])) {
    $emil = $_POST['email']; // Get the email from the form input
    
    // Validate the email format
    if (filter_var($emil, FILTER_VALIDATE_EMAIL)) {
        $domain = substr(strrchr($emil, "@"), 1); // Extract the domain part after '@'
        
        // Check if the domain exists (MX record lookup)
        if (checkdnsrr($domain, "MX")) {
            echo "Valid email address with existing domain.";
        } else {
            echo "Email domain does not exist.";
        }
    } else {
        echo "Invalid email format.";
    }
}
?>
